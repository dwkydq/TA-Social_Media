<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>XYZ Social</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        xyz: {
                            yellow: '#fbbf24',
                            black: '#000000',
                            dark: '#18181b'
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    {% if current_user.is_authenticated %}
        <div class="layout-container">
            
            <div class="sidebar flex flex-col h-screen sticky top-0 overflow-y-auto" style="padding-bottom: 20px;">
                
                <div class="flex-1">
                    <h1 class="xyz-logo" style="font-size: 2.5rem; padding-left: 20px;">XYZ.</h1>
                    
                    <a href="/" class="nav-item"><i class="fas fa-home"></i> Beranda</a>
                    <a href="/explore" class="nav-item"><i class="fas fa-hashtag"></i> Jelajahi</a>
                    <a href="/notifications" class="nav-item"><i class="fas fa-bell"></i> Notifikasi</a>
                    <a href="/chat" class="nav-item"><i class="fas fa-envelope"></i> Pesan</a>
                    <a href="/profile" class="nav-item"><i class="fas fa-user"></i> Profil</a>
                    
                    <button class="btn-xyz mt-4">Posting Baru</button>
                </div>

                <div class="mt-auto pt-4 border-t border-zinc-800/50">
                    <div class="flex items-center justify-between gap-2 p-3 rounded-full hover:bg-zinc-900 transition cursor-pointer border border-transparent hover:border-zinc-800 group">
                        
                        <a href="{{ url_for('user.my_profile') }}" class="flex items-center gap-3 flex-1 min-w-0">
                            <img src="{{ url_for('static', filename='uploads/' + current_user.profile_pic) if current_user.profile_pic else 'https://ui-avatars.com/api/?name=' + current_user.name }}" 
                                 class="w-10 h-10 rounded-full border border-gray-600 object-cover shrink-0">
                            
                            <div class="flex flex-col overflow-hidden">
                                <span class="font-bold text-white text-sm truncate group-hover:text-xyz-yellow transition">{{ current_user.name }}</span>
                                <span class="text-gray-500 text-xs truncate">@{{ current_user.username }}</span>
                            </div>
                        </a>

                        <a href="{{ url_for('auth.logout') }}" class="text-gray-400 hover:text-red-500 p-2 transition rounded-full hover:bg-zinc-800" title="Keluar">
                            <i class="fas fa-sign-out-alt text-lg"></i>
                        </a>

                    </div>
                </div>

            </div>

            <div class="feed">
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="bg-xyz-yellow text-black font-bold p-3 m-3 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]">
                                {{ message }}
                            </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}

                {% block content %}{% endblock %}
            </div>

            <div class="widgets">
    
                <div class="mb-6">
                    <form action="{{ url_for('frontend.search') }}" method="GET" class="relative">
                        <i class="fas fa-search absolute left-4 top-3.5 text-gray-500"></i>
                        <input type="text" name="q" placeholder="Cari pengguna..." autocomplete="off"
                               class="w-full bg-zinc-800 border-2 border-black rounded-full py-3 pl-12 pr-4 text-white placeholder-gray-500 focus:outline-none focus:border-xyz-yellow focus:shadow-[4px_4px_0px_0px_#fbbf24] transition">
                    </form>
                </div>

                <div class="bg-zinc-800 p-4 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] rounded-lg">
                    <h3 class="text-xyz-yellow font-bold text-xl mb-2">Trending di XYZ</h3>
                    <div class="font-bold text-white">#Python</div>
                    <small class="text-gray-400">12rb Postingan</small>
                    <div class="font-bold text-white">#WOWBGT</div>
                    <small class="text-gray-400">10rb Postingan</small>
                    <div class="font-bold text-white">#JuleSelingkuhLagi</div>
                    <small class="text-gray-400">8,5rb Postingan</small>
                    <div class="font-bold text-white">#AdalahPokoknya</div>
                    <small class="text-gray-400">7rb Postingan</small>
                </div>
            </div>
        </div>

    {% else %}
        <div class="auth-wrapper">
             <div style="position: absolute; top: 20px; width: 100%; max-width: 400px; z-index: 50;">
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="bg-red-500 text-white font-bold p-3 mb-2 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] text-center">
                                {{ message }}
                            </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
             </div>

            {% block auth_content %}{% endblock %}
        </div>
    {% endif %}

    <script src="https://cdn.jsdelivr.net/npm/@joeattardi/emoji-button@4.6.4/dist/index.min.js"></script>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>